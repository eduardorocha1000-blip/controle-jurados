<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %></title>
  <style>
    @page { size: A4; margin: 1cm; }
    body { margin: 0; font-family: Arial, Helvetica, sans-serif; }
    @media print { .no-print { display: none !important; } }
    .content { padding: 12px; }
    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-auto-rows: 6.4cm;
      gap: 0.1cm; /* 1mm */
    }
    .card {
      width: 6cm;
      height: 6.4cm;
      border: 0.3mm solid #000;
      box-sizing: border-box;
      padding: 2mm 2.5mm 2mm 2.5mm;
      margin: 0 auto;
      display: flex; flex-direction: column; justify-content: flex-start;
      line-height: 1; /* entrelinhas = 1 */
      page-break-inside: avoid;
    }
    .logo { height: 13px; display:block; }
    .top { display:flex; align-items:center; gap: 2mm; margin-bottom: 0.5mm; }
    .top .left { display:flex; flex-direction:column; align-items:center; }
    .top .logo { display:none; }
    .top .stack { display:flex; flex-direction:column; align-items:center; flex:1; }
    .seq { display:none; }
    .seq-status { display:none; }
    .num-top { font-size: 24px; font-weight: bold; margin-left: 4mm; line-height: 1; }
    .card .linha:first-of-type { margin-top: 0mm; }
    .comarca { text-align:center; font-size: 6pt; margin-bottom: 1mm; }
    .cpf { text-align:center; font-weight:bold; color:#0b4ea2; font-size: 12pt; margin-bottom: 0.5mm; }
    .status { text-align:center; font-size:7pt; font-weight:bold; margin-bottom: 0mm; text-transform: uppercase; }
    .status.ativo { color:#0c5b31; }
    .status.inativo { color:#6b0d0d; }
    .linha { border-top: 0.4mm solid #333; margin: 1.5mm 0; }
    .label { font-weight:bold; }
    .nome { font-size: 10pt; font-weight:bold; text-transform:uppercase; text-align:center; margin-bottom: 0.8mm; }
    .texto7 { font-size: 7pt; }
    .texto8 { font-size: 7pt; }
    .texto6 { font-size: 6pt; }
    .duas-colunas { columns: 2; column-gap: 3mm; font-size: 6pt; }
    .check { display:inline-block; width:3mm; height:3mm; border:0.2mm solid #000; margin-right:1mm; vertical-align:middle; }
    .centro { text-align:center; }
    .telefone { text-align:center; font-weight:bold; font-size: 10pt; }
    .profissao { color:#8B0000; font-weight:bold; font-size: 9px; }
    .endereco { margin-top: 0.2mm; margin-bottom: 0.8mm; }
    .mb2 { margin-bottom: 2mm; }
  </style>
</head>
<body>
  <div class="content">
      <div class="no-print d-flex justify-content-between align-items-center mb-2">
        <div class="d-flex align-items-center gap-2">
          <img src="<%= logoDataUrl %>" alt="TJSC" style="height:22px" />
          <strong>Impressão de Cédulas</strong>
          <span class="text-muted">— <%= statusFiltro %></span>
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" onclick="window.print()">Imprimir</button>
        </div>
      </div>
      <div class="grid">
    <% function formatCPF(c){ if(!c) return ''; const v=c.replace(/\D/g,'').padStart(11,'0'); return v.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,'$1.$2.$3-$4'); } %>
    <% jurados.forEach((j, idx) => { %>
      <div class="card">
        <div class="top">
          <div class="left">
            <div class="num-top"><%= (idx + 1) %></div>
          </div>
          <div class="stack" style="flex:1;">
            <div class="comarca">Comarca de Capivari de Baixo</div>
            <div class="cpf"><%= formatCPF(j.cpf||'') %></div>
            <div class="status <%= (j.status||'').toLowerCase()==='ativo'?'ativo':'inativo' %>">
              <%= (j.status||'').toUpperCase() %>
              <% if ((j.status||'')==='Inativo' && mostrarMotivo && j.motivo) { %>
                <span class="texto6" style="color:#6b0d0d; font-weight:normal; text-transform:none;"> (<%= j.motivo.toLowerCase() %>)</span>
              <% } %>
            </div>
            
          </div>
        </div>
        <div class="linha"></div>
        <div class="nome"><%= j.nome_completo || '' %></div>
        <% const end = (j.endereco||''); const num=(j.numero||''); const comp=(j.complemento||''); const bairro=(j.bairro||''); %>
        <div class="texto8 centro endereco" style="text-transform:uppercase;">
          <%= end %>, <%= num %><% if (comp) { %>, <%= comp %><% } %> - <%= bairro %>
        </div>
        <div class="texto8 centro profissao" style="text-transform:uppercase;">
          <%= (j.profissao || '') %>
        </div>
        <div class="telefone"> <%= j.telefone || '' %> </div>
        <div class="linha"></div>
        <div class="duas-colunas">
          <div><span class="check"></span>Suplente</div>
          <div><span class="check"></span>Não Encontrado</div>
          <div><span class="check"></span>Outra Comarca</div>
          <div><span class="check"></span>Não Compareceu</div>
          <div><span class="check"></span>Dispensa/Anterior</div>
          <div><span class="check"></span>Dispensa/Solenidade</div>
          <div><span class="check"></span>Recusa/Defesa</div>
          <div><span class="check"></span>Recusa/Acusação</div>
        </div>
        <div class="linha"></div>
        <div class="texto7" style="text-transform:uppercase;">
          <span class="check" style="margin-right:2mm;"></span><b>Conselho - Data: ___/___/____</b>
        </div>
      </div>
    <% }) %>
      </div>
  </div>
  <script>
    if (<%= autoPrint ? 'true':'false' %>) {
      window.addEventListener('load', () => setTimeout(()=>window.print(), 200));
    }
    window.addEventListener('afterprint', () => { window.location.href = '/cedulas'; });
  </script>
</body>
</html>


