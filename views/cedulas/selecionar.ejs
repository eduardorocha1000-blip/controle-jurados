<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %></title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link href="/css/style.css" rel="stylesheet">
  <style>
    body { height: 100vh; overflow: hidden; }
    .cedulas-selecionar-scroll { overflow-y: auto; }
    @media (max-width: 768px) { body { overflow: auto; height: auto; } .cedulas-selecionar-scroll { height: auto; } }
    
    /* Aumentar emoji do tÃ­tulo em 10px */
    .card-title:has(ğŸªª) {
      font-size: calc(1.25rem + 10px) !important;
    }
    
    /* BotÃ£o Imprimir com mesmo tamanho e estrutura do botÃ£o Salvar em Ãšltimo Conselho */
    #formCedulas .btn-edit.btn-sm {
      font-size: 22px !important;
      padding: 12px 14px !important;
    }
    #formCedulas .btn-edit.btn-sm * {
      font-size: 22px !important;
    }
  </style>
</head>
<body>
  <!-- CabeÃ§alho -->
  <header class="header-custom">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-auto">
          <img src="/images/logo-tjsc.png" alt="Logo TJSC" class="header-logo">
        </div>
        <div class="col">
          <h1 class="header-title">VARA ÃšNICA DA COMARCA DE CAPIVARI DE BAIXO</h1>
          <p class="header-subtitle">by Eduardo Motta Rocha da Silva</p>
        </div>
        <div class="col-auto">
          <% if (typeof user !== 'undefined' && user) { %>
          <div class="dropdown">
            <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
              ğŸ‘¤ <%= user.nome %>
            </button>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="/perfil">âš™ï¸ Perfil</a></li>
              <li><hr class="dropdown-divider"></li>
              <li>
                <form method="POST" action="/login/logout" class="d-inline">
                  <button type="submit" class="dropdown-item">ğŸšª Sair</button>
                </form>
              </li>
            </ul>
          </div>
          <% } %>
        </div>
      </div>
    </div>
  </header>

  <div class="main-container cedulas-selecionar-scroll" style="height: 604px; overflow-y: auto; flex: 1;">
    <!-- Sidebar -->
    <nav class="sidebar">
      <div class="p-3">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link" href="/dashboard">ğŸ“Š Dashboard</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/juizes">âš–ï¸ JuÃ­zes</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/instituicoes">ğŸ¢ InstituiÃ§Ãµes</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/jurados">ğŸ‘¥ Jurados</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/indicacoes">ğŸ“‹ IndicaÃ§Ãµes</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/sorteios">ğŸ² Sorteios</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/ultimo-conselho">ğŸ™‹ Ãšltimo Conselho</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/cedulas">ğŸ« CÃ©dulas</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/editais">ğŸ“„ Editais</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/emails">ğŸ“§ E-mails</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/relatorios">ğŸ“ˆ RelatÃ³rios</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/backup">ğŸ’¾ Backup</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/usuarios"><i class="fas fa-user-cog btn-icon"></i>UsuÃ¡rios</a>
          </li>
        </ul>
      </div>
    </nav>

    <!-- ConteÃºdo Principal -->
    <main class="main-content">
      <div class="container-fluid">
        <!-- CabeÃ§alho -->
        <div class="row mb-4">
          <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h2>CÃ©dulas</h2>
              </div>
            </div>
          </div>
        </div>

        <!-- FormulÃ¡rio de SeleÃ§Ã£o -->
        <div class="card mb-4">
          <div class="card-header">
            <h5 class="card-title mb-0"><span style="font-size: calc(1.25rem + 10px);">ğŸªª</span> ImpressÃ£o de CÃ©dulas</h5>
          </div>
          <div class="card-body">
            <form method="post" action="/cedulas/continuar" id="formCedulas" class="row g-3">
              <div class="col-md-auto">
                <label class="form-label">Status dos Jurados</label>
                <select name="status" class="form-select" required style="width: 15ch;">
                  <option value="Ativo">Ativos</option>
                  <option value="Inativo">Inativos</option>
                  <option value="Ambos" selected>Ambos</option>
                </select>
              </div>
              <div class="col-md-auto d-flex align-items-end">
                <button type="submit" class="btn btn-edit btn-sm" title="Imprimir">
                  ğŸ–¨ï¸
                </button>
              </div>
              <div class="col-12 mt-3 text-muted small">
                A impressÃ£o seguirÃ¡ o padrÃ£o: A4, margens 1 cm, 3 colunas x 4 linhas por folha, espaÃ§amento 1 mm entre cartÃµes e layout padronizado.
              </div>
            </form>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- RodapÃ© -->
  <footer class="footer-custom">
    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <p class="mb-0">Total de Jurados: <span id="total-jurados">-</span></p>
        </div>
        <div class="col-md-6 text-md-end">
          <p class="mb-0">Total de InstituiÃ§Ãµes: <span id="total-instituicoes">-</span></p>
        </div>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script>
    function ajustarAlturaScroll() {
      const header = document.querySelector('.header-custom');
      const footer = document.querySelector('.footer-custom');
      const container = document.querySelector('.cedulas-selecionar-scroll');
      if (!header || !footer || !container) return;
      const h = header.getBoundingClientRect().height;
      const f = footer.getBoundingClientRect().height;
      const altura = window.innerHeight - (h + f);
      container.style.height = altura + 'px';
      container.style.overflowY = 'auto';
    }
    window.addEventListener('load', ajustarAlturaScroll);
    window.addEventListener('resize', ajustarAlturaScroll);

    document.addEventListener('DOMContentLoaded', function() {
      ajustarAlturaScroll();

      // Fetch total de jurados e instituiÃ§Ãµes para o rodapÃ©
      fetch('/api/stats')
        .then(response => response.json())
        .then(data => {
          document.getElementById('total-jurados').textContent = data.totalJurados;
          document.getElementById('total-instituicoes').textContent = data.totalInstituicoes;
        })
        .catch(error => console.error('Erro ao buscar estatÃ­sticas:', error));
    });
  </script>
</body>
</html>


